
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>対話で学ぶメルセンヌツイスタ</title>
<meta name="viewport" content="width=device-width">
<link rel="stylesheet" href="../css/style.css">
<style>
li { margin: 0.8em 10px; }
</style>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
  TeX: {
    Macros: {
      floor: ['{\\lfloor #1 \\rfloor}', 1],
    }
  }
});
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script>
var MAP = {"ルイス": "lewis2", "マスター": "master2"};
function text(s) { return document.createTextNode(s); }
$(function () {
	var str = $("script[type='text/x-serif']").text();
	var buf = "";
	str.split("\n").forEach(function (line) {
		if (line == "") return;
		line = line.replace("」", "」<br>");
		if (!/「/.test(line)) {
			buf += line;
		} else {
			$("#out").append(buf);
			buf = "";
			var m = line.match(/^([^「]+)(.*)/);
			var name = m[1];
			var serif = m[2];
			$("#out").append("<img src='"+MAP[name]+".png'>").append(serif);
		}
	});
	$("#out").append(buf);
});
</script>
</head>
<body>
<script type="text/x-serif">
(※執筆途中)<br><br> 

ルイスは顔なじみのマスターがいるコーヒーショップにやってきた。<br>

マスター「いらっしゃい」
ルイス「よぁ、おやっさん。相変わらず客のいない店だな」
マスター「何か俺に用があってきたのか」
ルイス「あぁ実は聞きたいことがあって。おやっさんメルセンヌツイスタって知っているか？」
マスター「あぁ知っているさ。有名な疑似乱数生成アルゴリズムだろ？品質がとてもいいんだ。それがどうした」
ルイス「メルセンヌツイスタがどんな仕組みなのか知りたいんだ。メルセンヌツイスタの周期って$2^{19937}-1$で、これってメルセンヌ素数だろ？メルセンヌ素数がどう関係しているのか知りたいんだ」
マスター「ああ、なるほど。昔勉強したことがあるから、教えてやってもいいんだが…ルイス、お前、代数学は分かるのか？」
ルイス「ん～代数学か。ちゃんと勉強したことはないな」
マスター「そうか…」
ルイス「あぁでも、群・環・体の定義なら数学ガールという本で読んだことがある」
マスター「なるほど、じゃあイデアルって分かるか？」
ルイス「それは知らないな…」
マスター「う～ん、そうか。でも線形代数は勉強したことあるんだろ？線形代数がわかって群・環・体の定義を知っているならまあなんとか分かるように教えられるかもしれん」
ルイス「ほんとか！？」
マスター「まあ、期待はするなよ。それで注文は？」
<hr>
ルイスはキリマンジャロを注文した。マスターはお湯を沸かしている間に店の奥からキャスターつきのホワイトボードを運び出してきた。“擬似乱数と代数”と表紙に書かれたノートを脇に抱えている。<br>
マスター「で、メルセンヌツイスタなんだが…。実はこれを理解するためにメルセンヌツイスタだけに焦点を当てても本質は見えてこない。もっと一般的に状態空間が有限体上の線形空間で遷移関数が線形写像である有限オートマトンを考えた方がいい」
ルイス「どういうことだ？」
マスター「つまり、$d$次正方行列$A$を用いて現在の状態$\mathbf{x}_n$から次の状態$\mathbf{x}_{n+1}$が
$$\mathbf{x}_{n+1} = A \mathbf{x}_{n}$$
で得られるものだ。$\mathbf{x}_{n}$は$d$次元の縦ベクトルな」
ルイス「んんんん…っと。つまり、乱数を一つ生成するたびに現在の状態に行列$A$をかけるってことか。えっ、メルセンヌツイスタもこういうものなのか？」
マスター「ああそうだ。メルセンヌツイスタの場合は$A$が$19937$次の行列だな」
ルイス「ええっ。いやいや乱数を一つ生成するたびに$19937$次の行列なんて掛けていたら遅すぎて使いものにならないでしょう！？」
マスター「もちろん馬鹿正直に行列とベクトルの積を計算しているわけじゃない。行列$A$はコンピュータで簡単に計算できるものを選んでいるのさ」
ルイス「ふうん…」
マスター「あと、これら行列やベクトルの成分は実数ではない。$\mathbb{F}_2$の元だ」
ルイス「$\mathbb{F}_2$？なんだそれは」
マスター「集合$\{0, 1\}$に足し算と掛け算を定義してできる体だ。$1 + 1 = 0$であることだけが普通の数の演算と違う。」
ルイス「ああ、わかった。$\mathbb{Z}/2\mathbb{Z}$のことか。数学ガールで出てきたよ」
マスター「なんだ知っていたのか」
<hr>
マスター「と、ここで考えてほしい。メルセンヌツイスタの状態は体$\mathbb{F}_2$上の$19937$次元ベクトルだ。このベクトル全体がなす空間はいったいいくつの要素からなる？」
ルイス「ええと$\mathbb{F}_2$が要素数$2$なんだから…$2$の$19937$乗か。あれっこれってメルセンヌツイスタの周期？いやでも周期は$2^{19937}-1$だから$1$だけ違う？」
マスター「状態が$0$だと行列$A$を何回かけようが$0$だろう。だからメルセンヌツイスタは状態に$0$をとらないようにしている。$0$以外の元を初期状態に選んだとき、$0$以外のすべての状態を通って、$2^{19937}-1$回目に最初の状態に戻ってくる。」
マスター「図に書くとこんな感じだな。$2^{19937}$個は多すぎて書けないから$0$を含めて$8$個にした。」
<img src="mt-state-action.png"><br>
ルイス「あ、なるほど！この一つの丸が一つの状態を表しているのか。この図は$7$個の丸が並んでいるけどメルセンヌツイスタだったら$2^{19937}-1$個並んでいるってことか」
マスター「そういうことだ」
マスター「こんな風に$0$以外のすべての状態が一つの軌道に連なってくれると嬉しいわけだな。初期状態が$0$にならないようにだけ気を付ければどんな初期状態から始めても必ず周期が$(\text{全状態数})-1$になるわけだから」
ルイス「ふむ」
マスター「これを周期が最長になるって呼ぶことにしよう」
<hr>
マスター「じゃ、ここらで具体的な線形漸化式で周期を計算してみるか。次の問題を解いてみろ。」
$$
\mathbf{x} \mapsto A \mathbf{x},\;A = \begin{bmatrix}1 &1 &0 \\ 1 &0 &1 \\ 0 &0 &1\end{bmatrix}
$$
で決まる$\mathbb{F}_2^3$の変換による軌道を決定せよ。<br>

ルイス「分かった」

$$\begin{bmatrix}1\\0\\0\end{bmatrix} \to \begin{bmatrix}1\\1\\0\end{bmatrix} \to \begin{bmatrix}0\\1\\0\end{bmatrix} \to \begin{bmatrix}1\\0\\0\end{bmatrix}$$
$$\begin{bmatrix}0\\0\\1\end{bmatrix} \to \begin{bmatrix}0\\1\\1\end{bmatrix} \to \begin{bmatrix}1\\1\\1\end{bmatrix} \to \begin{bmatrix}0\\0\\1\end{bmatrix}$$
$$\begin{bmatrix}1\\0\\1\end{bmatrix} \to \begin{bmatrix}1\\0\\1\end{bmatrix}$$

ルイス「周期$3$の軌道が$2$個、周期$1$の軌道が$1$個あった。ただし零ベクトルは省いている」
マスター「つまりこれは最長周期でなかったということだ」

マスター「次はこれだ」
$$
\mathbf{x} \mapsto A \mathbf{x},\;A = \begin{bmatrix}1 &0 &1 \\ 0 &0 &1 \\ 1 &1 &1\end{bmatrix}
$$

ルイス「ふむ」

$$\begin{bmatrix}1\\0\\0\end{bmatrix} \to \begin{bmatrix}1\\0\\1\end{bmatrix} \to \begin{bmatrix}0\\1\\0\end{bmatrix} \to \begin{bmatrix}0\\0\\1\end{bmatrix} \to \begin{bmatrix}1\\1\\1\end{bmatrix} \to \begin{bmatrix}0\\1\\1\end{bmatrix} \to \begin{bmatrix}1\\1\\0\end{bmatrix} \to \begin{bmatrix}1\\0\\0\end{bmatrix}$$

ルイス「おお、これは周期が最長か」
マスター「そうだな」

ルイス「ところで今やった例はループするとき必ず最初の値に戻ってきた。A→B→C→D→C→D→…というふうに途中からループすることはないのか？」
マスター「さっきやった二つの例は両方行列が正則だった。正則なら途中からループすることはない」
マスター「正則というのは単射ということだからだ。単射なら異なる値BとDの像が同じ値Cになることはない。よってA→B→C→D→C→D→…のようなことは起こらない」
ルイス「そうか」

<hr>
マスター「さて、具体例も計算してみたところで考えて欲しいんだが、メルセンヌツイスタの周期は$2^{19937}-1$だろう」
ルイス「ああ」
マスター「どうやって確かめたと思う？」
ルイス「ん～。地道に確かめようとしたら$2^{19937}-1$回遷移関数を適用するってことを繰り返さなければいけないのか」
マスター「そうだ。もちろんそれは時間がかかりすぎて現実的でない。うまい方法がとられている」

マスター「実は周期が最長になることにはこんな必要十分条件がある。ただし$\#(\,\cdot\,)$は集合の要素数を表す記号だ」

<div class="framed">
<b>定理A</b><br>
$K$	を有限体とする。
$\mathbf{x} \in K^d - \{0\}$を初期値として$K$上の$d$次正方行列$A$による状態遷移を考える。<br>
これの周期が最長、つまり周期が$\#(K)^d - 1$となる必要十分条件は$A$の特性多項式が原始多項式となること。
</div>

ルイス「ふ～む。原始多項式って何だ？」
マスター「定義はこうだ」

<div class="framed">
$K$を有限体とする。
$f(t) \in K[t]$は$t$が$K[t]/f(t)$における$t$の乗法位数が$$\#(K)^{\deg f(t)}-1$$となるとき、原始多項式という
</div>

ルイス「さっぱり分からんのだが…」
マスター「$K[t]$は分かるか？」
ルイス「いや」
マスター「$K[t]$は$K$係数で$t$を変数とする一変数多項式がなす環だ」
ルイス「ははあ」
マスター「$K[t]/f(t)$は？」
ルイス「分からない」
マスター「そうか、イデアルは知らないんだったか。でも$\mathbb{Z}/n\mathbb{Z}$は知っているんだったな。それの類似で考えればいい」
マスター「$\mathbb{Z}/n\mathbb{Z}$は${\rm mod}\ n$の世界だ。正確な定義は書かないがこういうものだった」

<ul>
<li>任意の整数$a \in \mathbb{Z}$に対して$\overline{a} \in \mathbb{Z}/n\mathbb{Z}$が定まる。そして$\mathbb{Z}/n\mathbb{Z}$の元はすべて$\overline{a}$の形で表せる。
<li>(相等) $\overline{a}, \overline{b} \in \mathbb{Z}/n\mathbb{Z}$ に対し $\overline{a} = \overline{b} \iff a \equiv b \pmod{n}$
<li>(和) $\overline{a} + \overline{b} := \overline{a + b}$
<li>(積) $\overline{a}\cdot\overline{b} := \overline{ab}$
</ul>

たとえば
$$\mathbb{Z}/5\mathbb{Z} = \{\overline{0}, \overline{1}, \overline{2}, \overline{3}, \overline{4}\}, \\
\overline{2} + \overline{4} = \overline{6} = \overline{1}, \\
\overline{3}\cdot\overline{4} = \overline{12} = \overline{2}
$$
などなど。<br>

ルイス「ふむふむ。上に線を引く書き方は馴染みがないけれど、分かるよ」
マスター「同じように$K[t]/f(t)$は${\rm mod}\ f(t)$の世界だ。$f(t)$で割った余りを考える。多項式で割った余りって何か分かるか」
ルイス「$$g(t) = q(t)f(t) + r(t), \deg r(t) < \deg f(t)$$と表したときの$r(t)$のことか」
マスター「そう、それが$g(t)$を$f(t)$で割った余りだ。$g(t)$と$h(t)$の$f(t)$で割った余りが等しいことを$g(t) \equiv h(t) \pmod{f(t)}$と書く。」
ルイス「なるほど整数の合同と同じようなものだな」
マスター「そして$K[t]/f(t)$の定義は次の通りだ。もちろん正確性は多少犠牲にしてある」

<ul>
<li>任意の整数$g(t) \in K[t]$に対して$\overline{g(t)} \in K[t]/f(t)$が定まる。そして$K[t]/f(t)$の元はすべて$\overline{g(t)}$の形で表せる。
<li>(相等) $\overline{g(t)}, \overline{h(t)} \in K[t]/f(t)$ に対し $\overline{g(t)} = \overline{h(t)} \iff g(t) \equiv h(t) \pmod{f(t)}$
<li>(和) $\overline{g(t)} + \overline{h(t)} := \overline{g(t) + h(t)}$
<li>(積) $\overline{g(t)}\cdot\overline{h(t)} := \overline{g(t)h(t)}$<br>
</ul>

マスター「上で定義した和と積に関して$K[t]/f(t)$は環になる」

マスター「では具体例を出そうか。$\mathbb{F}_2[t]$で$(t^2+1)^2 \bmod (t^3+1)$を計算してみよ」
ルイス「こうか？」
\begin{eqnarray}
(t^2+1)^2 &\equiv& t^4+2t^2+1 \\
 &\equiv& t^4+1 \\ 
 &\equiv& (t^3+1)t - t + 1 \\ 
 &\equiv& - t + 1 \\
 &\equiv& t + 1 \pmod{t^3+1}
\end{eqnarray}
ルイス「途中で$\mathbb{F}_2$においては$2 = 0$, $-1 = 1$であることを使った」

マスター「よくわかっているじゃないか」
マスター「ということは$\mathbb{F}_2[t]/(t^3+1)$で$\overline{t^2+1}^2 = \overline{t+1}$となる」

マスター「この例のように$K[t]/f(t)$の元は次数が$f(t)$より小さい多項式$g(t)$によって$\overline{g(t)}$と表せる。$\mathbb{Z}/n\mathbb{Z}$の元は$n$未満の非負整数で表せるのと同じだ」
ルイス「ふむ」
マスター「ではクイズだ。$K[t]/f(t)$の元の数はいくつだ」
ルイス「ええと…。$f(t)$より次数が低い多項式の数を数えればいいのか。$\#(K)^{\deg f(t)}$かな。」
マスター「正解」

マスター「これで$K[t]/f(t)$はおおむね分かったな。ほかに原始多項式の定義に出てくるtermで分からないのはあるか？」
ルイス「あと分からないのは、$t$の乗法位数というのだけだ」
マスター「これは$K[t]/f(t)$において$\bar{t}^n = \bar{1}$となる最小の正整数$n$のことだな」
ルイス「何乗してはじめて$\bar{1}$になるかってことか…。ん？だとしたら$\bar{t}$の乗法位数って言うべきなんでは？」
マスター「その通りなんだが、上線はしばしば省略することがある」
マスター「あと$\bar{t}^n = \bar{1}$っていうのは$t^n \equiv 1 \pmod{f(t)}$と言い換えられることにも注意しろ。あと、こういう正整数$n$が必ずしも存在するとは限らない」

マスター「さて、原始多項式の定義に出てくるtermがすべて分かったところで以下の多項式が原始多項式か判定してもらおう」

$f_1(t), f_2(t), f_3(t), f_4(t) \in \mathbb{F}_2[t]$として

\begin{eqnarray}
f_1(t) &=& t^3 \\
f_2(t) &=& t^3+1 \\
f_3(t) &=& t^3+t+1 \\
f_4(t) &=& t^4+t^3+t^2+t+1
\end{eqnarray}

ルイス「要するに${\rm mod}\ f(t)$で$t$のべき乗を計算すればいいんだな」

<table style="margin: 30px 0">
<tr><th>$f(t)$<th>$t^3$<th>$t^3+1$<th>$t^3+t+1$<th>$t^4+t^3+t^2+t+1$
<tr><th>$t \bmod f(t)$<td>$t$<td>$t$<td>$t$<td>$t$
<tr><th>$t^2 \bmod f(t)$<td>$t^2$<td>$t^2$<td>$t^2$<td>$t^2$
<tr><th>$t^3 \bmod f(t)$<td>$0$<td>$1$<td>$t+1$<td>$t^3$
<tr><th>$t^4 \bmod f(t)$<td>$0$<td>$t$<td>$t^2+t$<td>$t^3+t^2+t+1$
<tr><th>$t^5 \bmod f(t)$<td>$0$<td>$t^2$<td>$t^2+t+1$<td>$1$
<tr><th>$t^6 \bmod f(t)$<td>$0$<td>$1$<td>$t^2+1$<td>$t$
<tr><th>$t^7 \bmod f(t)$<td>$0$<td>$t$<td>$1$<td>$t^2$
</table>

ルイス「よし分かった。原始多項式なのは$f_3(t) = t^3+t+1$ただ一つだ。これは$t$の乗法位数が$\#(\mathbb{F}_2)^{\deg f_3(t)}-1 = 2^3-1 = 7$になっている」
マスター「それでいい」

マスター「ここで${\rm mod}\ f_3(t)$での$t^n$に注目してほしい。$0$以外の$3$次未満の多項式がすべて現れているだろう」
ルイス「ああ、確かに」
マスター「これは原始多項式の定義、$t$の乗法位数は$\#(K)^{\deg f(t)}-1$であるということから任意の原始多項式で成り立つ」
ルイス「ふむ」
マスター「また、原始多項式なら$K[x]/f(x)$において$t$は乗法に関する逆元をもつ」
ルイス「んん～。あ、$t^n \equiv 1$となる$n$が存在するから$t\cdot t^{n-1} \equiv 1$となって、$t$は逆元$t^{n-1}$を持つ。確かに」
マスター「そう。一方で$K[t]/f(t)$で$0$以外の元は$t$のべきになることが分かったんだから、結局$K[x]/f(x)$の元は$0$を除いて逆元をもつ」
ルイス「なるほど」
マスター「今いった事実を一言で表せるか？」
ルイス「ええ？」
マスター「$K[t]/f(t)$は体になるということだ」
ルイス「ああ、そうか」
マスター「そしてここから$f(t)$は既約であることが言える」
ルイス「既約？」
マスター「そう、多項式はそれ以上因数分解できないなら既約であるという」
マスター「$f(t)$が既約なことを証明しよう。$f(t)$がそれ以上因数分解できるとしたら$f(t)$を割り切るような$p(t)$が存在する。ただし$1 \le \deg p(t) < \deg f(t)$」
マスター「さっきの議論より$p(t)$は逆元を持つ。すなわち$p(t) q(t) \equiv 1 \pmod{f(t)}$となる$q(t)$がある。すると$p(t)$と$f(t)$は互いに素だ。でも$p(t)$と$f(t)$はともに$p(t)$で割り切れるのだからこれは矛盾。よって$f(t)$は既約だ」
ルイス「ふむ」
マスター「ということで原始多項式は必ず既約多項式になる」
ルイス「そうか。ところで逆は成立しないのか？」
マスター「しない。上の$f_4(t) = t^4+t^3+t^2+t+1$は既約だけど原始多項式でない」
マスター「実は$f_1(t), f_2(t), f_3(t), f_4(t)$にはそれぞれ意図がある。
$f_1(t)$は$t$と互いに素でないから$t^n \equiv 1 \pmod{f(t)}$となる$n$は存在しない。
$f_2(t)$は既約でない。
$f_3(t)$は原始多項式。
$f_4(t)$は既約だが原始でない」
ルイス「なるほど…周到だ」

<hr>
マスター「じゃあ定理Aを具体例で確認しよう。以下の二つだ」

$$
\mathbf{x} \mapsto A_1 \mathbf{x},\;A_1 = \begin{bmatrix}1 &1 &0 \\ 1 &0 &1 \\ 0 &0 &1\end{bmatrix}
$$
$$
\mathbf{x} \mapsto A_2 \mathbf{x},\;A_2 = \begin{bmatrix}1 &0 &1 \\ 0 &0 &1 \\ 1 &1 &1\end{bmatrix}
$$

ルイス「あれこれ前やった奴じゃないか。上のが周期最長でなくて下のが周期最長だろう？」
マスター「そうだが、それは行列を何回もかけて調べた。定理を使っても同じ結果が出てくることを確かめよう」
ルイス「うい。特性多項式が原始多項式か調べればいいんだから、まず特性多項式を求めればいいんだな」

$$
\chi_{A_1}(t) = |tE - A_1| = \begin{vmatrix}t+1 &1 &0 \\ 1 &t &1 \\ 0 &0 &t+1\end{vmatrix} = t^3+1
$$

$$
\chi_{A_2}(t) = |tE - A_2| = \begin{vmatrix}t+1 &0 &1 \\ 0 &t &1 \\ 1 &1 &t+1\end{vmatrix} = t^3+t+1
$$

ルイス「あらっ。この多項式って原始多項式かどうかすでに調べた奴じゃないか」
マスター「まあな」
ルイス「やはり周到だ…。…とにかく$t^3+1$は原始多項式でないから$A_1$は周期最長でない、$t^3+t+1$は原始多項式だから$A_2$は周期最長だと。確かに結果が一致する」

<hr>
ルイス「ところで周期が最長になるためには原始多項式であることが必要十分という定理だが…」
マスター「ああ」
ルイス「証明は難しいのか？」
マスター「気になるか？」
ルイス「少し…」
マスター「よし、じゃあ証明してみるか」
そういうとマスターはホワイトボードを勢いよく消し始めた。<br>
ルイス「うおぉ…」
<hr>
マスター「さて示したいのは次の定理だ」
<div class="framed">
<b>定理A</b><br>
$K$	を有限体とする。
$\mathbf{x} \in K^d - \{0\}$を初期値として$K$上の$d$次正方行列$A$による状態遷移を考える。<br>
これの周期が最長、つまり周期が$\#(K)^d - 1$となる必要十分条件は$A$の特性多項式が原始多項式となること。
</div>
マスター「定理Aの代わりに定理A'を証明する」
<div class="framed">
<b>定理A'</b><br>
前提条件は定理Aと同じとする。<br>
周期が最長となる必要十分条件は$\varphi_{A,\mathbf{x}}(t)$が$d$次の原始多項式となること。
</div>
マスター「$\varphi_{A,\mathbf{x}}(t)$はこれから定義する」
マスター「次の補題が証明されたとしよう」
<div class="framed">
<b>補題</b><br>
$\varphi_{A,\mathbf{x}}(t)$が$d$次の原始多項式 $\iff$ $A$の特性多項式が原始多項式
</div>
マスター「すると定理A'から定理Aが導かれる。よって補題と定理A'を示せばいい」
マスター「では$\varphi_{A,\mathbf{x}}(t)$の定義をしよう」
<div class="framed">
定義<br>
多項式$\varphi(t) \in K[t]$で
$$\varphi(A)\mathbf{x} = 0$$
となるもののうち次数が最低で最高次係数が$1$であるものを$\varphi_{A,\mathbf{x}}(t)$と定める
</div>
マスター「では問題。$$\varphi(A)\mathbf{x} = 0$$を満たす多項式$\varphi(t) \in K[t]$は$\varphi_{A,\mathbf{x}}(t)$で割り切れることを示せ」
ルイス「は、はい。ん～と、余りをとればよさそうかなあ」

$\varphi(t)$を$\varphi_{A,\mathbf{x}}(t)$で割り算して
$$\varphi(t) = q(t)\varphi_{A,\mathbf{x}}(t) + r(t)$$
ただし$\deg r(t) < \deg \varphi_{A,\mathbf{x}}(t)$。<br>
変数$t$に行列$A$を代入して
$$\varphi(A) = q(A)\varphi_{A,\mathbf{x}}(A) + r(A)$$
両辺に右から$\mathbf{x}$をかけて
$$\varphi(A)\mathbf{x} = q(A)\varphi_{A,\mathbf{x}}(A)\mathbf{x} + r(A)\mathbf{x}$$
すると左辺と右辺第一項は$0$になるから
$$r(A)\mathbf{x} = 0$$
と。ええと、示したいのは$r(t) = 0$だよな…。どうすれば…。ああそうだ。<br>
もし$r(t) \ne 0$だとしたら$\deg r(t) < \deg \varphi_{A,\mathbf{x}}(t)$より$\varphi_{A,\mathbf{x}}(t)$の定義で次数を最低としていたことに反する。
よって$r(t) = 0$だ。したがって$\varphi(t)$は$\varphi_{A,\mathbf{x}}(t)$で割り切れる！<br>

ルイス「どうです！」
マスター「よしよし、それでいい。このあたりの議論はイデアルを使えばすっきりといくのだけど、それはいずれ環論を勉強したら振り返ってくれ」

マスター「さて、$A$の特性多項式を$\chi_A(t)$としよう。$\chi_A(t)$は$\varphi_{A,\mathbf{x}}(t)$で割り切れることが分かるかな？」
ルイス「ん…そうなのか？」
マスター「さっきの問題を使ってみい」
ルイス「ああそうか。さっきの問題を使えば、$\chi_A(A)\mathbf{x} = 0$を示せば$\varphi_{A,\mathbf{x}}(t)$で割り切れることがわかるのか」
マスター「そして$\chi_A(A)=O$となるというのはハミルトン・ケーリーの定理だ。だから$\chi_A(A)\mathbf{x} = 0$が言える」
ルイス「おおお。ハミルトン・ケーリーの定理！こんなところで出てくるとは」

マスター「では補題を証明しよう」
<div class="framed">
<b>補題</b><br>
$\varphi_{A,\mathbf{x}}(t)$が$d$次の原始多項式 $\iff$ $A$の特性多項式が原始多項式
</div>

マスター「まず$\varphi_{A,\mathbf{x}}(t)$が$d$次の原始多項式としよう。$\varphi_{A,\mathbf{x}}(t)$と$\chi_A(t)$はともに$d$次の多項式で最高次係数が$1$だ。そして$\chi_A(t)$は$\varphi_{A,\mathbf{x}}(t)$で割り切れるのだから両者は等しくないといけない。したがって$\chi_A(t)$は原始多項式だ。」
マスター「逆に$\chi_A(t)$が原始多項式だったとしよう。原始多項式は既約多項式だったので$\chi_A(t)$の因数$\varphi_{A,\mathbf{x}}(t)$は$1$か$\chi_A(t)$に等しい。もし$1$に等しかったら$\mathbf{x}=0$を導いてしまう。よって$\varphi_{A,\mathbf{x}}(t) = \chi_A(t)$より$\varphi_{A,\mathbf{x}}(t)$は$d$次の原始多項式だ。これで補題の証明終わり」
ルイス「なるほど…。何の条件もつけないときには$\varphi_{A,\mathbf{x}}(t)$と$\chi_A(t)$は等しくなるとはいえないけれど、補題の条件を仮定したときは等しくなることがいえるんだな」

マスター「よし次は定理A'の証明だ」

<div class="framed">
<b>定理A'</b><br>
$K$	を有限体とする。
$\mathbf{x} \in K^d - \{0\}$を初期値として$K$上の$d$次正方行列$A$による状態遷移を考える。<br>
この周期が最長となる必要十分条件は$\varphi_{A,\mathbf{x}}(t)$が$d$次の原始多項式となること。
</div>

マスター「まず、次のように同値変形ができる」

\begin{eqnarray}
A^n \mathbf{x} = \mathbf{x}
&\iff& (A^n - E) \mathbf{x} = 0 \\
&\iff& \varphi_{A,\mathbf{x}}(t) | (t^n - 1) \\
&\iff& t^n \equiv 1 \pmod{\varphi_{A,\mathbf{x}}(t)} \\
\end{eqnarray}

ルイス「$\varphi_{A,\mathbf{x}}(t) | (t^n - 1)$というのは？」
マスター「$t^n - 1$が$\varphi_{A,\mathbf{x}}(t)$で割り切れるという意味だ」
ルイス「ははあ。さっき俺が解いた問題を使ったのか」

マスター「これより、周期が$\#(K)^d - 1$になることは$t^n \equiv 1 \pmod{\varphi_{A,\mathbf{x}}(t)}$となる最小の正整数$n$が$\#(K)^d - 1$になることだといえる」

マスター「
$d' = \deg \varphi_{A,\mathbf{x}}(t)$とおく。
さらに$G = (K[t]/\varphi_{A,\mathbf{x}}(t))^\times$とおく」

ルイス「右肩にある$\times$ってなんだ？」
マスター「一般に環$R$に対して乗法の逆元が存在する元全体を$R^\times$と書く。これは乗法に関して群をなす」
マスター「それと${\rm ord}_G(t)$って記号は知っているか？」
ルイス「いや」
マスター「群$G$における$t$の位数、すなわち$t^n = 1$となる最小の正整数$n$のことだ。この記号を使うと周期が最長であることは${\rm ord}_G(t) = \#(K)^d - 1$と書けるな」

マスター「さて、

$${\rm ord}_G(t) \le \#(G) \le \#(K)^{d'} - 1 \le \#(K)^d - 1$$

により${\rm ord}_G(t) = \#(K)^d - 1$なら上の不等式ですべて等号が成り立たなければならない。よって周期が最長なら$\varphi_{A,\mathbf{x}}(t)$は$d$次の原始多項式だといえる。逆も確かめられる」

ルイス「んんん？考えさせてくれ。最後の不等号は$\varphi_{A,\mathbf{x}}(t)$が$\chi_A(t)$で割り切れるから$d' \le d$でOK。
真ん中の不等号については、集合$G = (K[t]/\varphi_{A,\mathbf{x}}(t))^\times$は、どの元も$K[t]/\varphi_{A,\mathbf{x}}(t)$の元であって$0$が含まれることはない。だから$\#(G)$は$K[t]/\varphi_{A,\mathbf{x}}(t)$の元の数引く$1$、つまり$\#(K)^{d'} - 1$で抑えられると。
んん、最初の不等号は？」
マスター「…」
ルイス「ヒント！」
マスター「これは一般の有限群$G$について成り立つんだ」
ルイス「あー群の元の位数は、群の位数を超えない…」
マスター「そう、群$G$の元$g$の位数が$n$だったら、$1, g, g^2, \ldots, g^{n-1}$は互いに異なる。すると$n$が$G$の位数$N$より大きければ、$G$には$N$個を超える元が存在することになり矛盾」
ルイス「そうか…」
マスター「これで納得したか？」
ルイス「いや、逆がまだ」



</script>
<div id="out"></div>
<h2>筆者より</h2>
<p>何か間違いか不正確なところがあればご報告ください。
<p>キャラクターの画像は「WOLF RPGエディター」の「グラフィック合成器」によって生成しました。
<h2>参考文献</h2>
<p>[1] 松本眞 (2004), 「<a href="http://www.math.sci.hiroshima-u.ac.jp/~m-mat/TEACH/0407-2.pdf">有限体の擬似乱数への応用</a>」
<p>[2] 雪江明彦 (2010), 『代数学1 群論入門』, 日本評論社
<p>[3] 雪江明彦 (2010), 『代数学2 環と体とガロア理論』, 日本評論社

</body>
</html>